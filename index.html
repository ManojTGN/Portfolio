<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§µ ManojTGN ‚Ä¢ Portfolio</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme:{
                extend: {
                    'animation': {
                        'text':'text 1s ease infinite',
                    },
                    'keyframes': {
                        'text': {
                            '0%, 100%': {
                            'background-size':'200% 200%',
                                'background-position': 'left center'
                            },
                            '50%': {
                            'background-size':'200% 200%',
                                'background-position': 'right center'
                            }
                        },
                    },
                    cursor: {
                        'fancy': 'url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\' width=\'40\' height=\'48\' viewport=\'0 0 100 100\' style=\'fill:black;font-size:24px;\'><text y=\'50%\'>üç°</text></svg>"), auto',
                    }
                }
            }
        }
    </script>

    <script src="https://kit.fontawesome.com/08c3f952c9.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    
    <style>
        @font-face {
            font-family: Pixellari;
            src: url(/asserts/Pixellari.ttf);
        }
        body{font-family: Pixellari;}
    </style>
</head>
<body class="m-0 p-0 w-screen h-screen flex items-center sm:justify-center gap-3 overflow-hidden bg-[#121212]">

<div class="sm:h-[1080px] sm:w-[1920px] flex flex-col items-center sm:justify-center gap-3">
    <canvas id="canvas" class=" absolute -z-10 opacity-0 hover:cursor-fancy"></canvas>
    <canvas id="oldcanvas" class=" absolute -z-10 opacity-0"></canvas>
    <canvas id="cursor" class=" absolute -z-10 opacity-0"></canvas>

    <div class="sm:w-[960px] w-5/6 flex gap-2">
        <span class="text-3xl text-yellow-300 hover:cursor-pointer">ManojTGN</span>
        <hr class="w-full my-4 border-solid border-1 border-yellow-300" />
        <span class="text-3xl my-2 text-yellow-300">*</span>
    </div>

    <div class="sm:w-[960px] w-5/6 flex sm:flex-row flex-col gap-5">
        <div class="sm:w-[480px] w-full flex items-center justify-center">
            <img src="./asserts/real_me.jpeg" class="w-[317px] rounded" loading="lazy" draggable="false"/>
        </div>
        <div class="w-[480px] flex flex-col">
            <p class="text-2xl text-white text-start">
                I'm <span class="text-yellow-300 hover:text-yellow-500 hover:cursor-pointer">Manoj</span>, aspiring Coder, interested in rendering engineering (computer graphics) and I'd love to enhance my knowledge about new and emerging trends in Information Technology domain. Thanks for visiting and I'd love to connect!
            </p>
            <div class="sm:text-5xl text-4xl text-yellow-300 py-12 flex items-center justify-center gap-5">
                <a class="hover:text-yellow-500" href="https://github.com/manojTGN" target="_blank"><i class="fa-brands fa-github"></i></a>
                <a class="hover:text-yellow-500" href="https://www.linkedin.com/in/manojbit/" target="_blank"><i class="fa-brands fa-linkedin"></i></a>
                <a class="hover:text-yellow-500 flex flex-col" href="https://drive.google.com/file/d/1YkDWnFv27z7AQwdJki7xhn-cPGYZLFox/view" target="_blank"><i class="fa-solid fa-file-lines"></i> <span class="text-base -mx-1">resume</span></a>
                <a class="hover:text-yellow-500" href="mailto:manojanguraja@gmail.com" target="_blank"><i class="fa-solid fa-envelope"></i></a>
                <a class="hover:text-yellow-500" href="https://www.instagram.com/_m4n0j_/" target="_blank"><i class="fa-brands fa-instagram"></i></a>
            </div>
        </div>
    </div>

    <div class="sm:w-[960px] w-5/6 flex gap-2">
        <span class="text-3xl text-yellow-300 hover:cursor-pointer">Projects</span>
        <hr class="w-full my-4 border-solid border-1 border-yellow-300" />
        <span class="text-3xl my-2 text-yellow-300">*</span>
    </div>

    <div class="sm:w-[960px] grid sm:grid-cols-3 grid-cols-1 gap-2">
        <a href="https://github.com/ManojTGN/cgrafix" target="_blank"><img class="hover:cursor-pointer" src="https://github-readme-stats.vercel.app/api/pin/?username=manojtgn&repo=cgrafix" draggable="false"/></a>
        <a href="https://github.com/T-G-N/hashmap.c" target="_blank"><img class="hover:cursor-pointer" src="https://github-readme-stats.vercel.app/api/pin/?username=T-G-N&repo=hashmap.c" draggable="false"/></a>
        <a href="https://github.com/ManojTGN/asciicam-cmd" target="_blank"><img class="hover:cursor-pointer" src="https://github-readme-stats.vercel.app/api/pin/?username=manojtgn&repo=asciicam-cmd" draggable="false"/></a>
        <a href="https://github.com/ManojTGN/collision2djs" target="_blank"><img class="hover:cursor-pointer" src="https://github-readme-stats.vercel.app/api/pin/?username=manojtgn&repo=collision2djs" draggable="false"/></a>
        <a href="https://github.com/ManojTGN/GrievanceForum" target="_blank"><img class="hover:cursor-pointer" src="https://github-readme-stats.vercel.app/api/pin/?username=manojtgn&repo=GrievanceForum" draggable="false"/></a>
        <a href="https://github.com/ManojTGN/aliveboard" target="_blank"><img class="hover:cursor-pointer" src="https://github-readme-stats.vercel.app/api/pin/?username=manojtgn&repo=aliveboard" draggable="false"/></a>
    </div>

    <div class="sm:w-[960px] sm:h-auto flex gap-2 w-0 h-0 overflow-hidden">
        <span class="text-3xl text-yellow-300 hover:cursor-pointer">Artist</span>
        <hr class="w-full my-4 border-solid border-1 border-yellow-300" />
        <span class="text-3xl my-2 text-yellow-300">*</span>
    </div>

    <div class="sm:w-[960px] sm:h-auto w-0 h-0 flex flex-row gap-5 items-center justify-center transition-all sm:overflow-visible overflow-hidden">
        <div class="text-2xl font-semibold bg-clip-text  text-transparent from-pink-500  to-yellow-500
        animate-text" style="background-image: linear-gradient(to top right, var(--tw-gradient-stops)) !important;"> Are You An Artist? </div>
        <button onclick="toggle()" id="toggleButton" class="z-20 px-6 py-1 bg-yellow-300 rounded text-[#121212] font-bold hover:bg-yellow-500 disabled:scale-90 hover:scale-110 transition-all outline outline-solid outline-yellow-300 hover:outline-yellow-500 outline-offset-2 disabled:outline-neutral-500 disabled:bg-neutral-300 disabled:text-neutral-700 disabled:cursor-wait" disabled="true"> <i class="fa-solid fa-circle-notch fa-spin"></i> . . .</button>
        <div id="colorContainer" class="flex gap-2 transition-all w-[0rem] hidden z-20">
            <input class="peer/white appearance-none" type="radio" name="color" id="whiteColor" value="rgba(255,255,255, 1)"/>
            <label for="whiteColor" class="hover:cursor-pointer rounded-full bg-white w-5 h-5 peer-checked/white:outline outline-solid outline-offset-2 outline-white"></label>

            <input class="peer/yellow appearance-none" type="radio" name="color" id="yellowColor" value="rgba(250, 204, 21, 1)"/>
            <label for="yellowColor" class="hover:cursor-pointer rounded-full bg-yellow-400 w-5 h-5 peer-checked/yellow:outline outline-solid outline-offset-2 outline-yellow-400"></label>

            <input class="peer/red appearance-none" type="radio" name="color" id="redColor" value="rgba(248, 113, 113, 1)" checked="true"/>
            <label for="redColor" class="hover:cursor-pointer rounded-full bg-red-400 w-5 h-5 peer-checked/red:outline outline-solid outline-offset-2 outline-red-400"></label>

            <input class="peer/green appearance-none" type="radio" name="color" id="greenColor" value="rgba(74, 222, 128, 1)"/>
            <label for="greenColor" class="hover:cursor-pointer rounded-full bg-green-400 w-5 h-5 peer-checked/green:outline outline-solid outline-offset-2 outline-green-400"></label>
            
            <input class="peer/blue appearance-none" type="radio" name="color" id="blueColor" value="rgba(96, 165, 250, 1)"/>
            <label for="blueColor" class="hover:cursor-pointer rounded-full bg-blue-400 w-5 h-5 peer-checked/blue:outline outline-solid outline-offset-2 outline-blue-400"></label>

            <input class="peer/black appearance-none" type="radio" name="color" id="blackColor" value="rgba(0, 0, 0, 1)"/>
            <label for="blackColor" class="hover:cursor-pointer rounded-full bg-black w-5 h-5 peer-checked/black:outline outline-solid outline-offset-2 outline-black"></label>

            <input class="peer/orange appearance-none" type="radio" name="color" id="orangeColor" value="rgba(251, 146, 60, 1)"/>
            <label for="orangeColor" class="hover:cursor-pointer rounded-full bg-orange-400 w-5 h-5 peer-checked/orange:outline outline-solid outline-offset-2 outline-orange-400"></label>
        </div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
    import { getDatabase, onChildAdded, ref, set, get, push } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCQ9mTZwMFbRo2n0qz5ywtmreHDQUzdz4k",
        authDomain: "portfolio-manojtgn.firebaseapp.com",
        projectId: "portfolio-manojtgn",
        storageBucket: "portfolio-manojtgn.appspot.com",
        messagingSenderId: "814984845554",
        appId: "1:814984845554:web:10d7c36cc7ec4ebf73186b",
        measurementId: "G-716G5659NM",
        databaseURL: "https://portfolio-manojtgn-default-rtdb.asia-southeast1.firebasedatabase.app/",
    };
    
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);

    const database = getDatabase(app);
    const year = new Date().getFullYear();
    const reference = ref(database, `lines/${year}/`);


    const CANVAS = document.getElementById("canvas");
    const CONTEXT = CANVAS.getContext('2d');

    const CURSORS = document.getElementById("cursor");
    const CURSORSCONTEXT = CURSORS.getContext('2d');

    const OLDCANVAS = document.getElementById("oldcanvas");
    const OLDCONTEXT = OLDCANVAS.getContext('2d');

    let flipper = 0;
    let DRAWNDATA = [];
    let isOldDataDrawn = false;
    let isOldDataInitialized = false;

    CANVAS.width = 1920;//document.documentElement.clientWidth;
    CANVAS.height = 1080;//document.documentElement.clientHeight;

    OLDCANVAS.width = 1920;//document.documentElement.clientWidth;
    OLDCANVAS.height = 1080;//document.documentElement.clientHeight;

    CURSORS.width = 1920;//document.documentElement.clientWidth;
    CURSORS.height = 1080;//document.documentElement.clientHeight;

    let PAINT_MODE = false;
    let IS_MOUSE_DOWN = false;
    let TMP_DRAW_DATA =  {color:null, points:[]};
    let LAST_DRAW_DATA = {color:null, points:[]};

    get(reference).then((snapshot) => {
        if (snapshot.exists()) { DRAWNDATA = snapshot.val();}
        isOldDataInitialized = true;
        document.getElementById('toggleButton').removeAttribute('disabled');
        document.getElementById('toggleButton').innerHTML = `<i class="fa-solid fa-square-check"></i> Yes`;
    }).catch((error) => { document.getElementById('toggleButton').innerHTML = `<i class="fa-solid fa-square-xmark"></i> Err`;console.error(error); });

    async function uploadDrawData(TMP_DRAW_DATA){
        set(push(reference),{
            color:TMP_DRAW_DATA.color,
            points:TMP_DRAW_DATA.points
        });
    }

    function drawPoint(context, x, y) {
        context.lineTo(x, y);
        context.stroke();
    }

    CANVAS.onmousedown = function (event) {
        if(!PAINT_MODE || IS_MOUSE_DOWN) return;

        IS_MOUSE_DOWN = true;
        CONTEXT.beginPath();
        CONTEXT.lineCap = "round";
        CONTEXT.lineJoin = "round";
        CONTEXT.strokeStyle = document.querySelector('input[name="color"]:checked').value;
        CONTEXT.fillStyle = document.querySelector('input[name="color"]:checked').value;
        TMP_DRAW_DATA.color = document.querySelector('input[name="color"]:checked').value;
        CONTEXT.lineWidth = 5;
    }

    CANVAS.onmouseup = function (event) {
        if(!PAINT_MODE || !IS_MOUSE_DOWN) return;

        IS_MOUSE_DOWN = false;
        CONTEXT.closePath();
        
        LAST_DRAW_DATA.color = TMP_DRAW_DATA.color;
        LAST_DRAW_DATA.points = TMP_DRAW_DATA.points;
        uploadDrawData(TMP_DRAW_DATA);
        
        TMP_DRAW_DATA.color = null;
        TMP_DRAW_DATA.points = [];
    }

    CANVAS.onmousemove = function (event) {
        flipper++;
        if(!PAINT_MODE || !IS_MOUSE_DOWN || flipper<=2) return;

        drawPoint(CONTEXT, event.offsetX, event.offsetY);
        TMP_DRAW_DATA.points.push([event.offsetX, event.offsetY]);
        flipper = 0;
    }

    onChildAdded(reference, async (data) => {
        if(!isOldDataInitialized || (LAST_DRAW_DATA.color == data.val().color && JSON.stringify(LAST_DRAW_DATA.points[0]) == JSON.stringify(data.val().points[0])) ){
            return;
        }

        if(!isOldDataDrawn){
            DRAWNDATA.push(data.val());
            return;
        }

        const NEWDATA = data.val();
        
        OLDCONTEXT.beginPath();
        OLDCONTEXT.lineCap = "round";
        OLDCONTEXT.lineJoin = "round";
        OLDCONTEXT.lineWidth = 5;

        OLDCONTEXT.strokeStyle = NEWDATA.color;
        OLDCONTEXT.fillStyle = NEWDATA.color;

        let index = 0;
        CURSORSCONTEXT.fillStyle =  NEWDATA.color;
        CURSORSCONTEXT.font = "16px Pixellari";
        CURSORSCONTEXT.lineWidth = 5;
        
        while( index < NEWDATA.points.length ){
            await new Promise(resolve => setTimeout(()=>{

                CURSORSCONTEXT.beginPath();
                OLDCONTEXT.beginPath();
                CURSORSCONTEXT.fillStyle = NEWDATA.color;
                if(index > 0) {
                    OLDCONTEXT.moveTo(NEWDATA.points[index-1][0], NEWDATA.points[index-1][1] );
                    CURSORSCONTEXT.moveTo(NEWDATA.points[index-1][0], NEWDATA.points[index-1][1] );
                    CURSORSCONTEXT.clearRect(NEWDATA.points[index-1][0]-10, NEWDATA.points[index-1][1]-15,NEWDATA.points[index-1][0] +110,NEWDATA.points[index-1][1]+20);
                }

                OLDCONTEXT.strokeStyle = NEWDATA.color;
                OLDCONTEXT.fillStyle = NEWDATA.color;
                drawPoint(OLDCONTEXT, NEWDATA.points[index][0],NEWDATA.points[index][1]);

                CURSORSCONTEXT.strokeText(" üèÉrandomUser", NEWDATA.points[index][0], NEWDATA.points[index][1]);
                CURSORSCONTEXT.fillText(" üèÉrandomUser", NEWDATA.points[index][0], NEWDATA.points[index][1]);
                CURSORSCONTEXT.closePath();
                OLDCONTEXT.closePath();
                resolve();
            }, 70))
            index++;
        }

        CURSORSCONTEXT.clearRect(NEWDATA.points[NEWDATA.points.length-1][0]-10, NEWDATA.points[NEWDATA.points.length-1][1]-15,NEWDATA.points[NEWDATA.points.length-1][0] +110,NEWDATA.points[NEWDATA.points.length-1][1]+20);
        OLDCONTEXT.closePath();
    });

    window.toggle = async function(){
        PAINT_MODE = !PAINT_MODE;

        if(PAINT_MODE){
            document.getElementById('toggleButton').innerHTML = `üòÜ No`;
            document.getElementById('colorContainer').className = document.getElementById('colorContainer').className.replace('w-[0rem] hidden', 'w-[18rem]');
            CANVAS.className = CANVAS.className.replace('-z-10 opacity-0','z-10');
            CURSORS.className = CURSORS.className.replace('-z-10 opacity-0','z-0');
            OLDCANVAS.className = OLDCANVAS.className.replace('-z-10 opacity-0','z-0');

            if(!isOldDataDrawn && DRAWNDATA){

                let keyIndex = 0;
                let KEYS = Object.keys(DRAWNDATA);
                while(keyIndex < KEYS.length && PAINT_MODE){
                    let key = KEYS[keyIndex];
                    if(!DRAWNDATA[key].color || !DRAWNDATA[key].points){
                        keyIndex++;
                        continue;
                    }

                    OLDCONTEXT.beginPath();
                    OLDCONTEXT.lineCap = "round";
                    OLDCONTEXT.lineJoin = "round";
                    OLDCONTEXT.lineWidth = 5;

                    OLDCONTEXT.strokeStyle = DRAWNDATA[key].color;
                    OLDCONTEXT.fillStyle = DRAWNDATA[key].color;
                    
                    let index = 0;
                    while(index < DRAWNDATA[key].points.length && PAINT_MODE){
                        await new Promise(resolve => setTimeout(()=>{drawPoint(OLDCONTEXT, DRAWNDATA[key].points[index][0],DRAWNDATA[key].points[index][1]);resolve();}, 5))
                        index++;
                    }

                    OLDCONTEXT.closePath();
                    keyIndex++;
                }

                if(!PAINT_MODE){
                    OLDCONTEXT.clearRect(0, 0, CANVAS.width, CANVAS.height);
                }else{
                    isOldDataDrawn = true;
                    DRAWNDATA = [];
                }
            }

            return;  
        }

        document.getElementById('toggleButton').innerHTML = `<i class="fa-solid fa-square-check"></i> Yes`;
        document.getElementById('colorContainer').className = document.getElementById('colorContainer').className.replace('w-[18rem]', 'w-[0rem] hidden');
        CANVAS.className = CANVAS.className.replace('z-10','-z-10 opacity-0');
        CURSORS.className = CURSORS.className.replace('z-0','-z-10 opacity-0');
        OLDCANVAS.className = OLDCANVAS.className.replace('z-0','-z-10 opacity-0');

        if(!isOldDataDrawn){
            OLDCONTEXT.clearRect(0, 0, CANVAS.width, CANVAS.height);
        }
        
    }

</script>

</body>
</html>